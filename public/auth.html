<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Login - HatchBridge Visit</title>
  <meta name="description" content="Sign in to HatchBridge Visitor Management System">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#000824">
  <link rel="icon" type="image/png" href="assets/branding/hb-web-icon.png">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="hatchbridge-theme.css">
  <link rel="stylesheet" href="auth.css">
</head>
<body>
  <div class="auth-container">
    <div class="auth-card">
      <!-- Logo -->
      <div class="auth-logo">
        <img src="assets/branding/hb-webfavicon.png" alt="HatchBridge" height="60">
        <h1>HatchBridge Visit</h1>
      </div>

      <!-- Mode Toggle: Login / Register -->
      <div class="auth-mode-toggle">
        <button type="button" class="mode-btn active" data-mode="login">Login</button>
        <button type="button" class="mode-btn" data-mode="register">Register</button>
      </div>

      <!-- Role Tabs -->
      <div class="role-tabs" role="tablist" aria-label="Select your role">
        <button type="button" class="role-tab active" data-role="Visitor" aria-selected="true">
          <span class="role-icon">ğŸ‘¤</span>
          Visitor
        </button>
        <button type="button" class="role-tab" data-role="Guard" aria-selected="false">
          <span class="role-icon">ğŸ›¡ï¸</span>
          Guard
        </button>
        <button type="button" class="role-tab" data-role="Admin" aria-selected="false">
          <span class="role-icon">âš™ï¸</span>
          Admin
        </button>
      </div>

      <!-- Login Form -->
      <form id="authForm" class="auth-form" novalidate>
        <!-- Name field (register only) -->
        <div class="form-group register-only" style="display: none;">
          <label for="nameInput">Full Name</label>
          <input 
            type="text" 
            class="form-control" 
            id="nameInput" 
            placeholder="Enter your full name"
            autocomplete="name"
          >
          <div class="invalid-feedback" id="nameError"></div>
        </div>

        <!-- Identifier field (phone for Visitor, userId for Staff) -->
        <div class="form-group">
          <label for="identifierInput" id="identifierLabel">Mobile number</label>
          <div class="phone-input-wrapper" id="phoneInputWrapper">
            <select id="countryCode" class="form-control country-select">
              <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
              <option value="+44">ğŸ‡¬ğŸ‡§ +44</option>
              <option value="+91">ğŸ‡®ğŸ‡³ +91</option>
              <option value="+86">ğŸ‡¨ğŸ‡³ +86</option>
              <option value="+81">ğŸ‡¯ğŸ‡µ +81</option>
              <option value="+49">ğŸ‡©ğŸ‡ª +49</option>
              <option value="+33">ğŸ‡«ğŸ‡· +33</option>
              <option value="+61">ğŸ‡¦ğŸ‡º +61</option>
              <option value="+55">ğŸ‡§ğŸ‡· +55</option>
              <option value="+52">ğŸ‡²ğŸ‡½ +52</option>
            </select>
            <input 
              type="tel" 
              class="form-control phone-number" 
              id="phoneInput" 
              placeholder="(555) 123-4567"
              autocomplete="tel"
              inputmode="tel"
            >
          </div>
          <input 
            type="text" 
            class="form-control staff-input" 
            id="userIdInput" 
            placeholder="Enter your User ID"
            autocomplete="username"
            style="display: none;"
          >
          <small class="form-text text-muted" id="identifierHelper">Use the same number you registered with</small>
          <div class="invalid-feedback" id="identifierError"></div>
        </div>

        <!-- Password field -->
        <div class="form-group">
          <label for="passwordInput">Password</label>
          <div class="password-wrapper">
            <input 
              type="password" 
              class="form-control" 
              id="passwordInput" 
              placeholder="Enter your password"
              autocomplete="current-password"
            >
            <button type="button" class="password-toggle" aria-label="Show password">
              <span class="eye-icon">ğŸ‘ï¸</span>
            </button>
          </div>
          <div class="caps-lock-warning" id="capsWarning" style="display: none;">
            âš ï¸ Caps Lock is on
          </div>
          <div class="invalid-feedback" id="passwordError"></div>
        </div>

        <!-- Confirm Password (register only) -->
        <div class="form-group register-only" style="display: none;">
          <label for="confirmPasswordInput">Confirm Password</label>
          <div class="password-wrapper">
            <input 
              type="password" 
              class="form-control" 
              id="confirmPasswordInput" 
              placeholder="Confirm your password"
              autocomplete="new-password"
            >
            <button type="button" class="password-toggle" aria-label="Show password">
              <span class="eye-icon">ğŸ‘ï¸</span>
            </button>
          </div>
          <div class="invalid-feedback" id="confirmPasswordError"></div>
        </div>

        <!-- Error Alert -->
        <div class="alert alert-danger auth-error" id="authError" style="display: none;" role="alert">
          <span id="errorMessage"></span>
          <button type="button" class="error-action" id="errorAction" style="display: none;"></button>
        </div>

        <!-- Success Alert -->
        <div class="alert alert-success auth-success" id="authSuccess" style="display: none;" role="alert">
          <span id="successMessage"></span>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary btn-block auth-submit" id="submitBtn" disabled>
          <span class="btn-text">Login</span>
          <span class="btn-loading" style="display: none;">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Please wait...
          </span>
        </button>
      </form>

      <!-- Footer Links -->
      <div class="auth-footer">
        <p class="login-prompt">
          Don't have an account? <button type="button" class="link-btn" id="switchToRegister">Register here</button>
        </p>
        <p class="register-prompt" style="display: none;">
          Already have an account? <button type="button" class="link-btn" id="switchToLogin">Login here</button>
        </p>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmationModalLabel">ğŸ‰ Registration Successful!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Welcome to HatchBridge Visit!</p>
          <p class="login-identifier">
            <strong>Your login identifier:</strong><br>
            <code id="loginIdentifierDisplay"></code>
          </p>
          <p class="text-muted small">Use this number along with your password to log in.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary btn-block" id="goToLogin">Go to Login</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  <script src="auth.js"></script>
</body>
</html>
